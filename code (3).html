<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Tool Obfuscator (JS/JSON)</title>
    <!-- Obfuscator Library -->
    <script src="https://cdn.jsdelivr.net/npm/javascript-obfuscator/dist/index.browser.js"></script>
    <!-- JSZip Library for ZIP handling -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        /* --- Theme Variables & Base Styles --- */
        /* ... (Copy the full CSS block from the previous "Forced Maximum" response) ... */
        /* Add styles for Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--input-border);
            margin-bottom: 20px;
        }
        .tab-button {
            padding: 10px 15px;
            cursor: pointer;
            background: none;
            border: none;
            border-bottom: 3px solid transparent; /* Indicator */
            color: var(--checkbox-label-color);
            font-size: 1em;
            margin-bottom: -1px; /* Overlap border */
            transition: color 0.2s ease, border-color 0.2s ease;
        }
        .tab-button:hover {
            color: var(--text-color);
        }
        .tab-button.active {
            color: var(--title-color);
            border-bottom-color: var(--title-color);
            font-weight: bold;
        }
        .tab-content {
            display: none; /* Hide inactive tabs */
        }
        .tab-content.active {
            display: block; /* Show active tab */
        }
        /* Style for file input */
        input[type="file"] {
            background-color: var(--input-bg);
            border: 1px solid var(--input-border);
            color: var(--text-color);
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.9em;
            cursor: pointer;
            width: 100%;
            box-sizing: border-box;
            margin-bottom: 10px; /* Space below file input */
        }
         input[type="file"]::file-selector-button { /* Style the button inside */
             background-color: var(--button-bg);
             color: var(--button-text);
             border: none;
             padding: 6px 10px;
             border-radius: 3px;
             margin-right: 10px;
             cursor: pointer;
              transition: background-color 0.2s;
         }
          input[type="file"]::file-selector-button:hover {
              background-color: var(--button-hover-bg);
          }

        /* Ensure consistent button styles */
        button { /* General button styles */
            background-color: var(--button-bg);
            color: var(--button-text);
            border: none;
            padding: 10px 25px;
            font-size: 1em;
            font-weight: bold;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease;
            width: fit-content;
            margin-top: 10px;
        }
         button:hover { background-color: var(--button-hover-bg); }
         button:active { transform: translateY(1px); }
         button:disabled {
             opacity: 0.6;
             cursor: not-allowed;
         }

        /* Copy CSS Variables and Base Styles from previous version here... */
        :root{--bg-color:#0a192f;--stars-color:#ccd6f6;--text-color:#ccd6f6;--input-bg:#1e2a47;--input-border:#3a4b6f;--button-bg:#ff6b6b;--button-text:#fff;--button-hover-bg:#e05252;--title-color:#ff6b6b;--checkbox-label-color:#a0b0d0;--warning-color:#ff4d4d;--select-bg:var(--input-bg);--select-border:var(--input-border);--select-text:var(--text-color);--meteor-color:rgba(204,214,246,.6);--ripple-color:rgba(255,107,107,.5);--modal-bg:color-mix(in srgb,var(--bg-color) 95%,black);--modal-border:var(--input-border);--close-button-bg:var(--input-bg);--close-button-hover-bg:color-mix(in srgb,var(--input-bg) 80%,white);--close-button-text:var(--text-color)}body.theme-blood-moon{--bg-color:#0a090c;--stars-color:#f0dbdc;--text-color:#f0dbdc;--input-bg:#4b0909;--input-border:#5c0b0b;--button-bg:#e6c4c4;--button-text:#4b0909;--button-hover-bg:#f0dbdc;--title-color:#dcbd5a;--checkbox-label-color:#d6a0a1;--warning-color:#b8595a;--select-bg:var(--input-bg);--select-border:var(--input-border);--select-text:var(--text-color);--meteor-color:rgba(240,219,220,.6);--ripple-color:rgba(220,189,90,.5);--modal-bg:color-mix(in srgb,var(--bg-color) 95%,black);--modal-border:var(--input-border);--close-button-bg:var(--input-bg);--close-button-hover-bg:color-mix(in srgb,var(--input-bg) 80%,white);--close-button-text:var(--text-color)}body.theme-ocean{--bg-color:#105774;--stars-color:#def3fc;--text-color:#def3fc;--input-bg:#034f75;--input-border:#04618f;--button-bg:#63c8f2;--button-text:#034f75;--button-hover-bg:#a6e0f7;--title-color:#23e727;--checkbox-label-color:#a6e0f7;--warning-color:#f39ab6;--select-bg:var(--input-bg);--select-border:var(--input-border);--select-text:var(--text-color);--meteor-color:rgba(222,243,252,.6);--ripple-color:rgba(35,231,39,.5);--modal-bg:color-mix(in srgb,var(--bg-color) 95%,black);--modal-border:var(--input-border);--close-button-bg:var(--input-bg);--close-button-hover-bg:color-mix(in srgb,var(--input-bg) 80%,white);--close-button-text:var(--text-color)}body.theme-purple{--bg-color:#330f3a;--stars-color:#e8ddeb;--text-color:#e8ddeb;--input-bg:#501e3b;--input-border:#622549;--button-bg:#c3a5c9;--button-text:#330f3a;--button-hover-bg:#d9c7dd;--title-color:#454acc;--checkbox-label-color:#c3a5c9;--warning-color:#a8e070;--select-bg:var(--input-bg);--select-border:var(--input-border);--select-text:var(--text-color);--meteor-color:rgba(232,221,235,.6);--ripple-color:rgba(69,74,204,.5);--modal-bg:color-mix(in srgb,var(--bg-color) 95%,black);--modal-border:var(--input-border);--close-button-bg:var(--input-bg);--close-button-hover-bg:color-mix(in srgb,var(--input-bg) 80%,white);--close-button-text:var(--text-color)}html{scroll-behavior:smooth}body{margin:0;padding:0;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif;color:var(--text-color);background-color:var(--bg-color);overflow:hidden;min-height:100vh;transition:background-color .3s ease}#star-canvas{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;display:block;cursor:pointer}.container{width:95%;max-width:900px;margin:20px auto;padding:15px;background-color:color-mix(in srgb,var(--bg-color) 85%,black);border-radius:8px;box-shadow:0 4px 15px rgba(0,0,0,.4);position:relative;z-index:1;transition:background-color .3s ease;max-height:calc(100vh - 40px);overflow-y:auto;box-sizing:border-box}.header-controls{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding:0 5px;flex-wrap:wrap;gap:10px}h1{color:var(--title-color);text-align:left;font-weight:600;letter-spacing:.5px;margin:0;font-size:1.5em;flex-grow:1}button.settings-button{background:none;border:1px solid var(--input-border);color:var(--checkbox-label-color);padding:6px 12px;border-radius:4px;cursor:pointer;font-size:.9em;transition:background-color .2s,border-color .2s}button.settings-button:hover{background-color:var(--input-bg);border-color:var(--button-bg)}p.subtitle{text-align:center;margin-top:5px;margin-bottom:25px;color:var(--warning-color);font-size:.9em;font-weight:700}.io-area{display:flex;flex-direction:column;gap:15px;margin-bottom:15px}textarea{width:100%;min-height:200px;background-color:var(--input-bg);border:1px solid var(--input-border);color:var(--text-color);font-family:Consolas,Monaco,monospace;font-size:13px;padding:10px;border-radius:5px;box-sizing:border-box;resize:vertical;box-shadow:inset 0 1px 3px rgba(0,0,0,.3);transition:background-color .3s ease,border-color .3s ease}textarea:focus{outline:none;border-color:var(--button-bg);box-shadow:0 0 0 2px color-mix(in srgb,var(--button-bg) 30%,transparent)}.controls{display:flex;flex-direction:column;align-items:center;gap:15px;margin-top:10px}button#obfuscate-button{margin-top:0!important} /* Reset margin for buttons in controls */label.area-label{display:block;margin-bottom:6px;font-weight:500;font-size:1em;color:var(--text-color)}.status{text-align:center;margin-top:10px;font-style:italic;color:var(--warning-color);min-height:1.2em;font-size:.9em;font-weight:700}.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.6);display:flex;justify-content:center;align-items:center;z-index:1000;opacity:0;visibility:hidden;transition:opacity .3s ease,visibility .3s ease}.modal-overlay.visible{opacity:1;visibility:visible}.modal-content{background-color:var(--modal-bg);padding:25px;border-radius:8px;border:1px solid var(--modal-border);box-shadow:0 5px 20px rgba(0,0,0,.5);width:90%;max-width:400px;position:relative;transform:scale(.9);transition:transform .3s ease}.modal-overlay.visible .modal-content{transform:scale(1)}.modal-content h2{margin-top:0;margin-bottom:20px;color:var(--title-color);text-align:center;font-weight:500}.modal-theme-selector{display:flex;align-items:center;justify-content:center;gap:10px;margin-bottom:25px}.modal-theme-selector label{font-size:1em;color:var(--checkbox-label-color)}.modal-theme-selector select{padding:8px 12px;background-color:var(--select-bg);color:var(--select-text);border:1px solid var(--select-border);border-radius:4px;font-size:1em;flex-grow:1}.modal-theme-selector select:focus{outline:none;border-color:var(--button-bg)}button.close-button{position:absolute;top:10px;right:10px;background:var(--close-button-bg);border:1px solid var(--input-border);color:var(--close-button-text);border-radius:50%;width:30px;height:30px;font-size:18px;line-height:28px;text-align:center;cursor:pointer;padding:0;transition:background-color .2s,transform .2s}button.close-button:hover{background-color:var(--close-button-hover-bg);transform:rotate(90deg)}

    </style>
</head>
<body class=""> <!-- JS applies theme -->
    <canvas id="star-canvas"></canvas>

    <!-- Settings Modal -->
    <div id="settings-overlay" class="modal-overlay">
        <div id="settings-modal-content" class="modal-content">
             <button id="close-settings-button" class="close-button" title="Close Settings">&times;</button>
            <h2>Settings</h2>
            <div class="modal-theme-selector">
                 <label for="modal-theme-select">Theme:</label>
                 <select id="modal-theme-select">
                     <option value="default">Default (Danger)</option>
                     <option value="theme-blood-moon">Blood Moon</option>
                     <option value="theme-ocean">Ocean</option>
                     <option value="theme-purple">Purple</option>
                 </select>
             </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <div class="header-controls">
             <h1>Multi-Tool Obfuscator</h1>
             <button id="settings-button" class="settings-button" title="Open Settings">Settings ⚙️</button>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab-button active" onclick="openTab(event, 'jsObfuscatorTab')">JS Obfuscator (Extreme)</button>
            <button class="tab-button" onclick="openTab(event, 'jsonMinifierTab')">JSON Minifier</button>
        </div>

        <!-- JS Obfuscator Tab Content -->
        <div id="jsObfuscatorTab" class="tab-content active">
            <p class="subtitle">Applies FORCED Maximum Obfuscation - Very High Risk of Script Failure!</p>
            <div class="io-area">
                <div>
                    <label class="area-label" for="input-code-js">Paste JS Code OR Upload Files:</label>
                    <textarea id="input-code-js" spellcheck="false" placeholder="import { world } from '@minecraft/server';..." rows="8"></textarea>
                    <input type="file" id="file-input-js" accept=".js,.txt,.zip" multiple title="Select .js, .txt, or a .zip file">
                </div>

                <div class="controls">
                    <button id="obfuscate-button">APPLY MAX OBFUSCATION</button>
                    <button id="download-zip-button" disabled>Download Obfuscated ZIP</button>
                 </div>
                 <div class="status" id="status-js">Select files or paste code. Click Obfuscate.</div>

                <div>
                    <label class="area-label" for="output-code-js">Obfuscated Output (Preview/Single File):</label>
                    <textarea id="output-code-js" readonly placeholder="Output preview (or single file content) appears here... Download ZIP for multiple files."></textarea>
                </div>
            </div>
        </div>

        <!-- JSON Minifier Tab Content -->
        <div id="jsonMinifierTab" class="tab-content">
             <p class="subtitle" style="color: var(--checkbox-label-color); font-weight: normal;">Remove whitespace from JSON data.</p>
             <div class="io-area">
                 <div>
                    <label class="area-label" for="input-code-json">Paste JSON Data Here:</label>
                    <textarea id="input-code-json" spellcheck="false" placeholder='{\n  "key": "value",\n  "number": 123,\n  "array": [1, 2, 3]\n}' rows="8"></textarea>
                </div>
                <div class="controls">
                    <button id="minify-button">Minify JSON</button>
                 </div>
                  <div class="status" id="status-json">Paste JSON and click Minify.</div>
                 <div>
                    <label class="area-label" for="output-code-json">Minified JSON Output:</label>
                    <textarea id="output-code-json" readonly placeholder='{"key":"value","number":123,"array":[1,2,3]}'></textarea>
                </div>
             </div>
        </div>

    </div> <!-- End Container -->

    <script>
        // --- Canvas & Background (Meteors, Ripples, Stars - Same Logic) ---
        const canvas = document.getElementById('star-canvas'); const ctx = canvas.getContext('2d');
        let stars = []; let ripples = []; let meteors = []; const numStars = 120;
        let mouse = { x: undefined, y: undefined, radius: 100 };
        window.addEventListener('mousemove', (event) => { mouse.x = event.clientX; mouse.y = event.clientY; });
        window.addEventListener('mouseout', () => { mouse.x = undefined; mouse.y = undefined; });
        canvas.addEventListener('click', (event) => { ripples.push({ x: event.clientX, y: event.clientY, radius: 0, maxRadius: 50, life: 1.0 }); });
        function getCssVariable(variableName) { try { return getComputedStyle(document.documentElement).getPropertyValue(variableName).trim() || ''; } catch (e) { return ''; } }
        function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; createStars(); }
        function createStars() { stars = []; for (let i = 0; i < numStars; i++) { stars.push({ originX: Math.random() * canvas.width, originY: Math.random() * canvas.height, x: Math.random() * canvas.width, y: Math.random() * canvas.height, radius: Math.random() * 1.2 + 0.5, alpha: Math.random() * 0.7 + 0.3, deltaAlpha: (Math.random() - 0.5) * 0.015, vx: 0, vy: 0, hue: Math.random() * 360, isNearMouse: false }); } }
        function createMeteor() { const side = Math.floor(Math.random() * 4); let startX, startY, endX, endY; switch (side) { case 0: startX = Math.random() * canvas.width; startY = -10; endX = startX + (Math.random() - 0.5) * canvas.width * 0.8; endY = canvas.height + 10; break; case 1: startX = canvas.width + 10; startY = Math.random() * canvas.height; endX = -10; endY = startY + (Math.random() - 0.5) * canvas.height * 0.8; break; case 2: startX = Math.random() * canvas.width; startY = canvas.height + 10; endX = startX + (Math.random() - 0.5) * canvas.width * 0.8; endY = -10; break; default: startX = -10; startY = Math.random() * canvas.height; endX = canvas.width + 10; endY = startY + (Math.random() - 0.5) * canvas.height * 0.8; break; } const dx = endX - startX; const dy = endY - startY; const speed = Math.random() * 3 + 4; meteors.push({ x: startX, y: startY, len: Math.random() * 60 + 30, vx: (dx / Math.sqrt(dx*dx + dy*dy)) * speed, vy: (dy / Math.sqrt(dx*dx + dy*dy)) * speed, life: 1.0 }); }
        function updateAndDrawBackground() {
             ctx.clearRect(0, 0, canvas.width, canvas.height); const repulsionStrength = 1.5; const returnStrength = 0.008; const dampening = 0.95; const defaultStarColor = getCssVariable('--stars-color') || '#ccd6f6';
             stars.forEach(star => { let dxMouse = 0; let dyMouse = 0; let distanceMouse = Infinity; star.isNearMouse = false; if (mouse.x !== undefined && mouse.y !== undefined) { dxMouse = star.x - mouse.x; dyMouse = star.y - mouse.y; distanceMouse = Math.sqrt(dxMouse * dxMouse + dyMouse * dyMouse); if (distanceMouse < mouse.radius) { star.isNearMouse = true; const forceDirectionX = dxMouse / distanceMouse; const forceDirectionY = dyMouse / distanceMouse; const forceMagnitude = (mouse.radius - distanceMouse) / mouse.radius; star.vx += forceDirectionX * forceMagnitude * repulsionStrength; star.vy += forceDirectionY * forceMagnitude * repulsionStrength; star.hue = (star.hue + 1.5) % 360; } } const dxOrigin = star.originX - star.x; const dyOrigin = star.originY - star.y; star.vx += dxOrigin * returnStrength; star.vy += dyOrigin * returnStrength; star.vx *= dampening; star.vy *= dampening; star.x += star.vx; star.y += star.vy; if (star.x < 0 || star.x > canvas.width) star.vx *= -0.5; if (star.y < 0 || star.y > canvas.height) star.vy *= -0.5; star.x = Math.max(0, Math.min(canvas.width, star.x)); star.y = Math.max(0, Math.min(canvas.height, star.y)); star.alpha += star.deltaAlpha; if (star.alpha <= 0.1 || star.alpha >= 1.0) { star.deltaAlpha *= -1; star.alpha = Math.max(0.1, Math.min(1.0, star.alpha)); } ctx.beginPath(); ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2); if (star.isNearMouse) { ctx.fillStyle = `hsla(${star.hue}, 100%, 75%, ${star.alpha * 1.2})`; } else { let color = defaultStarColor; let alpha = star.alpha; if (color.startsWith('#')) { let r = parseInt(color.slice(1, 3), 16)||0; let g = parseInt(color.slice(3, 5), 16)||0; let b = parseInt(color.slice(5, 7), 16)||0; ctx.fillStyle = `rgba(${r}, ${g}, ${b}, ${alpha})`; } else if (color.startsWith('rgb')) { ctx.fillStyle = color.replace('rgb', 'rgba').replace(')', `, ${alpha})`); } else { ctx.fillStyle = `rgba(204, 214, 246, ${alpha})`; } } ctx.fill(); });
             const rippleColor = getCssVariable('--ripple-color') || 'rgba(100, 255, 218, 0.5)'; for (let i = ripples.length - 1; i >= 0; i--) { const ripple = ripples[i]; ripple.radius += 1.5; ripple.life -= 0.02; if (ripple.life <= 0) { ripples.splice(i, 1); continue; } ctx.beginPath(); ctx.arc(ripple.x, ripple.y, ripple.radius, 0, Math.PI * 2); ctx.strokeStyle = rippleColor.replace(/[\d\.]+\)$/g, `${ripple.life})`); ctx.lineWidth = 2; ctx.stroke(); }
             const meteorColor = getCssVariable('--meteor-color') || 'rgba(204, 214, 246, 0.6)'; if (Math.random() < 0.006 && meteors.length < 4) { createMeteor(); } for (let i = meteors.length - 1; i >= 0; i--) { const meteor = meteors[i]; meteor.x += meteor.vx; meteor.y += meteor.vy; meteor.life -= 0.005; const tailX = meteor.x - meteor.vx * (meteor.len / Math.sqrt(meteor.vx*meteor.vx + meteor.vy*meteor.vy)); const tailY = meteor.y - meteor.vy * (meteor.len / Math.sqrt(meteor.vx*meteor.vx + meteor.vy*meteor.vy)); if (meteor.life <= 0 || meteor.x < -50 || meteor.x > canvas.width + 50 || meteor.y < -50 || meteor.y > canvas.height + 50) { meteors.splice(i, 1); continue; } const gradient = ctx.createLinearGradient(meteor.x, meteor.y, tailX, tailY); gradient.addColorStop(0, meteorColor.replace(/[\d\.]+\)$/g, `${meteor.life})`)); gradient.addColorStop(1, meteorColor.replace(/[\d\.]+\)$/g, `0)`) ); ctx.beginPath(); ctx.moveTo(meteor.x, meteor.y); ctx.lineTo(tailX, tailY); ctx.strokeStyle = gradient; ctx.lineWidth = 1.5; ctx.stroke(); }
        }
        function animate() { updateAndDrawBackground(); requestAnimationFrame(animate); }
        window.addEventListener('resize', resizeCanvas); resizeCanvas(); animate();

         // --- Settings Modal & Theming Logic ---
        const settingsButton = document.getElementById('settings-button'); const settingsOverlay = document.getElementById('settings-overlay');
        const closeSettingsButton = document.getElementById('close-settings-button'); const modalThemeSelect = document.getElementById('modal-theme-select');
        const body = document.body;
        function applyTheme(themeName) { body.className = themeName === 'default' ? '' : themeName; localStorage.setItem('obfuscatorTheme', themeName); modalThemeSelect.value = themeName; }
        function showSettingsModal() { settingsOverlay.classList.add('visible'); } function hideSettingsModal() { settingsOverlay.classList.remove('visible'); }
        settingsButton.addEventListener('click', showSettingsModal); closeSettingsButton.addEventListener('click', hideSettingsModal);
        settingsOverlay.addEventListener('click', (event) => { if (event.target === settingsOverlay) hideSettingsModal(); });
        const savedTheme = localStorage.getItem('obfuscatorTheme') || 'default'; applyTheme(savedTheme);
        modalThemeSelect.addEventListener('change', (event) => { applyTheme(event.target.value); });

        // --- Tab Logic ---
        function openTab(event, tabName) {
            let i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
                tabcontent[i].classList.remove("active");
            }
            tablinks = document.getElementsByClassName("tab-button");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].classList.remove("active");
            }
            document.getElementById(tabName).style.display = "block";
            document.getElementById(tabName).classList.add("active");
            event.currentTarget.classList.add("active");
        }
        // Initialize first tab
        document.addEventListener('DOMContentLoaded', () => {
             document.querySelector('.tab-button.active').click();
        });


        // --- Obfuscation & Minification Logic ---
        const inputCodeJsEl = document.getElementById('input-code-js');
        const fileInputJsEl = document.getElementById('file-input-js');
        const outputCodeJsEl = document.getElementById('output-code-js');
        const obfuscateButton = document.getElementById('obfuscate-button');
        const downloadZipButton = document.getElementById('download-zip-button');
        const statusJsEl = document.getElementById('status-js');

        const inputCodeJsonEl = document.getElementById('input-code-json');
        const outputCodeJsonEl = document.getElementById('output-code-json');
        const minifyButton = document.getElementById('minify-button');
        const statusJsonEl = document.getElementById('status-json');

        let obfuscatedFilesData = {}; // Store { filename: obfuscatedContent }

        // --- JS Obfuscation ---
        const hardcodedMaxObfuscationOptions = { // MAX AGGRESSION Settings
            compact: true, controlFlowFlattening: true, controlFlowFlatteningThreshold: 1.0, deadCodeInjection: true, deadCodeInjectionThreshold: 1.0,
            disableConsoleOutput: false, identifierNamesGenerator: 'hexadecimal', log: false, numbersToExpressions: true,
            renameGlobals: false, /* CRITICAL */ rotateStringArray: true, shuffleStringArray: true, splitStrings: true, splitStringsChunkLength: 5,
            stringArray: true, stringArrayIndexShift: true, stringArrayWrappersCount: 5, stringArrayWrappersChainedCalls: true,
            stringArrayWrappersParametersMaxCount: 7, stringArrayWrappersType: 'function', stringArrayThreshold: 1.0,
            transformObjectKeys: true, simplify: true, target: 'browser', stringArrayEncoding: ['rc4'], /* Hardcoded RC4 */
            unicodeEscapeSequence: true, /* Hardcoded Unicode Escape */ forceTransformStrings: [''], /* Hardcoded Force Transform */
            renameProperties: true, /* <<< Hardcoded - EXTREME RISK */ renamePropertiesMode: 'safe',
            selfDefending: true, /* <<< Hardcoded - EXTREME RISK */ debugProtection: true, /* <<< Hardcoded - EXTREME RISK */
            debugProtectionInterval: 4000,
        };

        function obfuscateCode(code, filename = 'output.js') {
             try {
                 const result = JavaScriptObfuscator.obfuscate(code, hardcodedMaxObfuscationOptions);
                 return result.getObfuscatedCode();
             } catch (error) {
                 console.error(`Obfuscation Error for ${filename}:`, error);
                 statusJsEl.textContent = `Error obfuscating ${filename}. Check console.`;
                 // Return original code with error comment? Or just null?
                 return `// OBFUSCATION FAILED for ${filename}: ${error.message}\n\n${code}`;
             }
        }

        function readFileAsText(file) {
             return new Promise((resolve, reject) => {
                 const reader = new FileReader();
                 reader.onload = (event) => resolve(event.target.result);
                 reader.onerror = (error) => reject(error);
                 reader.readAsText(file);
             });
         }

        async function handleJsObfuscation() {
             obfuscatedFilesData = {}; // Reset previous results
             outputCodeJsEl.value = ''; // Clear preview
             downloadZipButton.disabled = true;
             statusJsEl.textContent = 'Processing...';
             obfuscateButton.disabled = true; // Prevent multiple clicks

             const files = fileInputJsEl.files;
             const pastedCode = inputCodeJsEl.value.trim();
             let processedCount = 0;

             try {
                 if (files.length > 0) {
                     // --- File Input Mode ---
                     statusJsEl.textContent = `Processing ${files.length} file(s)...`;
                     for (const file of files) {
                         const fileName = file.name.toLowerCase();
                         if (fileName.endsWith('.zip')) {
                             // --- Handle ZIP ---
                             statusJsEl.textContent = `Reading ${file.name}...`;
                             const zip = await JSZip.loadAsync(await file.arrayBuffer());
                             const promises = [];
                             zip.forEach((relativePath, zipEntry) => {
                                 if (!zipEntry.dir && (relativePath.toLowerCase().endsWith('.js') || relativePath.toLowerCase().endsWith('.txt'))) {
                                      statusJsEl.textContent = `Obfuscating ${relativePath}...`;
                                     promises.push(
                                         zipEntry.async('string').then(content => {
                                             const obfuscatedContent = obfuscateCode(content, relativePath);
                                             if (obfuscatedContent) {
                                                 obfuscatedFilesData[relativePath] = obfuscatedContent;
                                                 processedCount++;
                                             }
                                         }).catch(err => {
                                             console.error(`Error reading ${relativePath} from ZIP:`, err);
                                             statusJsEl.textContent = `Error reading ${relativePath} from ZIP.`;
                                         })
                                     );
                                 }
                             });
                             await Promise.all(promises);
                         } else if (fileName.endsWith('.js') || fileName.endsWith('.txt')) {
                             // --- Handle single JS/TXT file ---
                              statusJsEl.textContent = `Obfuscating ${file.name}...`;
                             const content = await readFileAsText(file);
                             const obfuscatedContent = obfuscateCode(content, file.name);
                             if (obfuscatedContent) {
                                 obfuscatedFilesData[file.name] = obfuscatedContent;
                                 processedCount++;
                                 // Show preview for the first successful single file
                                 if (processedCount === 1 && files.length === 1) {
                                      outputCodeJsEl.value = obfuscatedContent;
                                 }
                             }
                         } else {
                             console.warn(`Skipping unsupported file type: ${file.name}`);
                         }
                     } // End of file loop

                 } else if (pastedCode) {
                     // --- Pasted Code Mode ---
                     statusJsEl.textContent = 'Obfuscating pasted code...';
                     const obfuscatedContent = obfuscateCode(pastedCode, 'pasted_code.js');
                     if (obfuscatedContent && !obfuscatedContent.startsWith('// OBFUSCATION FAILED')) {
                         obfuscatedFilesData['obfuscated_code.js'] = obfuscatedContent;
                         outputCodeJsEl.value = obfuscatedContent; // Show in preview
                         processedCount = 1;
                     }
                 } else {
                     statusJsEl.textContent = 'No code pasted or files selected.';
                      obfuscateButton.disabled = false;
                     return;
                 }

                 // --- Finalize ---
                 if (processedCount > 0) {
                     statusJsEl.textContent = `Obfuscation complete for ${processedCount} file(s)! Click Download ZIP.`;
                     downloadZipButton.disabled = false;
                     if (processedCount === 1 && !outputCodeJsEl.value) {
                         // If only one file was processed (e.g., from zip) show its preview
                         outputCodeJsEl.value = Object.values(obfuscatedFilesData)[0];
                     } else if (processedCount > 1) {
                          outputCodeJsEl.value = `// Preview of first file (${Object.keys(obfuscatedFilesData)[0]}):\n\n${Object.values(obfuscatedFilesData)[0]}\n\n// --- Download ZIP for all ${processedCount} files ---`;
                     }

                 } else {
                     statusJsEl.textContent = 'No valid JS/TXT files found or obfuscation failed for all.';
                 }

             } catch (error) {
                 console.error("Processing error:", error);
                 statusJsEl.textContent = `An error occurred: ${error.message}. Check console.`;
             } finally {
                  obfuscateButton.disabled = false; // Re-enable button
                   fileInputJsEl.value = ''; // Clear file input selection
             }
         }

         function downloadObfuscatedZip() {
             if (Object.keys(obfuscatedFilesData).length === 0) return;

             statusJsEl.textContent = 'Creating ZIP file...';
             const zip = new JSZip();

             for (const filename in obfuscatedFilesData) {
                 zip.file(filename, obfuscatedFilesData[filename]);
             }

             zip.generateAsync({ type: "blob" })
                 .then(function(content) {
                     const link = document.createElement('a');
                     link.href = URL.createObjectURL(content);
                     link.download = "obfuscated_scripts.zip";
                     document.body.appendChild(link);
                     link.click();
                     document.body.removeChild(link);
                     URL.revokeObjectURL(link.href); // Clean up
                     statusJsEl.textContent = `Downloaded obfuscated_scripts.zip (${Object.keys(obfuscatedFilesData).length} files).`;
                 })
                 .catch(err => {
                     console.error("Error creating ZIP:", err);
                     statusJsEl.textContent = "Error creating ZIP file. Check console.";
                 });
         }


        // --- JSON Minification ---
        function handleJsonMinify() {
            const jsonInput = inputCodeJsonEl.value.trim();
            statusJsonEl.textContent = '';
            outputCodeJsonEl.value = '';

            if (!jsonInput) {
                statusJsonEl.textContent = 'Input JSON is empty.';
                return;
            }

            try {
                const jsonObject = JSON.parse(jsonInput);
                outputCodeJsonEl.value = JSON.stringify(jsonObject); // Minified output
                statusJsonEl.textContent = 'JSON Minified Successfully!';
            } catch (error) {
                console.error("JSON Parse Error:", error);
                outputCodeJsonEl.value = `// Invalid JSON:\n// ${error.message || error}`;
                statusJsonEl.textContent = 'Invalid JSON input. Check console.';
            }
        }

        // --- Event Listeners ---
        obfuscateButton.addEventListener('click', handleJsObfuscation);
        downloadZipButton.addEventListener('click', downloadObfuscatedZip);
        minifyButton.addEventListener('click', handleJsonMinify);
        // Add listeners for file input if needed (e.g., update status on selection)
        fileInputJsEl.addEventListener('change', () => {
            if (fileInputJsEl.files.length > 0) {
                statusJsEl.textContent = `${fileInputJsEl.files.length} file(s) selected. Click Obfuscate.`;
                inputCodeJsEl.value = ''; // Clear text area if files are chosen
            }
        });

    </script>
</body>
</html>